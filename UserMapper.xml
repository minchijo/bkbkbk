<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.bookbookbook.dao.UserDAO">

	<!--회원가입-->
	<insert id="registerUser" parameterType="UserVO">
    	INSERT INTO users (
        	userId,  password, userName, userTel, 
        	gender, birthDate, joinedDate) 
    	VALUES (
        	#{userId}, #{password}, #{userName}, #{userTel},
        	#{gender}, #{birthDate}, now() )
	</insert>
	
	<!-- 이메일 실시간 중복 체크 -->
	<select id="existsByUserId" resultType="int">
        SELECT COUNT(*) FROM users WHERE userId = #{email}
    </select>

	<!-- 로그인 -->
	<select id="loginUser" parameterType="String" resultType="UserVO">
        SELECT * FROM users WHERE userId = #{userId}
    </select>

	
    <select id="findEmail" resultType="String">
        SELECT userId FROM users 
        WHERE userName = #{userName} AND userTel = #{userTel}
    </select>
    
    
    <update id="updatePassword">
        UPDATE users SET password = #{newPassword} 
        WHERE userId = #{userId}
    </update>
    
    
    <select id="checkDuplicateUser" resultType="int">
    	SELECT COUNT(*) FROM users 
    	WHERE userId = #{userId} OR userTel = #{userTel}
	</select>
	
    
   
<!--채팅-->
<insert id="submitReport" parameterType="ReportVO">
INSERT INTO report (chatroomNum, reportedUser, reportTime, reportType, reportUser) VALUES (#{chatroomNum},#{reportedUser},${reportTime},#{reportType},#{reportUser})
</insert>

</mapper>